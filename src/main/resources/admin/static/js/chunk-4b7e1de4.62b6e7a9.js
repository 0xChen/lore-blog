(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4b7e1de4"],{2371:function(t,e,a){"use strict";var n=a("7426"),o=a.n(n);o.a},7426:function(t,e,a){t.exports={primaryColor:"#3298dc",menuTextColor:"rgba(255,255,255,.65)",menuActiveTextColor:"#3298dc",menuBackgroundColor:"#324157",sidebarWidth:"210px",sidebarCollapsedWidth:"64px",headerHeight:"64px"}},"7c2b":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"post"},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"postForm",attrs:{"label-position":"right","label-width":"80px",model:t.post,"status-icon":"",rules:t.postRules}},[a("el-row",[a("el-col",{attrs:{lg:12,md:24}},[a("el-form-item",{attrs:{label:"文章标题",prop:"title"}},[a("el-input",{attrs:{placeholder:"请输入文章标题(必须)"},model:{value:t.post.title,callback:function(e){t.$set(t.post,"title",e)},expression:"post.title"}})],1)],1),a("el-col",{attrs:{lg:12,md:24}},[a("el-form-item",{attrs:{label:"缩略名称",prop:"slug"}},[a("el-input",{attrs:{placeholder:"用于自定义访问路径"},model:{value:t.post.slug,callback:function(e){t.$set(t.post,"slug",e)},expression:"post.slug"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{lg:12,md:24}},[a("el-form-item",{attrs:{label:"文章标签",prop:"tags"}},[t._l(t.dynamicTags,(function(e){return a("el-tag",{key:e,attrs:{closable:"","disable-transitions":!1,type:["success","info","warning","danger"][Math.floor(4*Math.random())]},on:{close:function(a){return t.deleteTag(e)}}},[t._v(" "+t._s(e)+" ")])})),t.tagInputVisible?a("el-input",{ref:"tagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:t.tagInputConfirm},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.tagInputConfirm(e)}},model:{value:t.tagInputValue,callback:function(e){t.tagInputValue=e},expression:"tagInputValue"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.showTagInput}},[t._v(" + 新标签 ")])],2)],1),a("el-col",{attrs:{lg:12,md:24}},[a("el-form-item",{attrs:{label:"文章分类",prop:"categoryId"}},[a("el-cascader",{attrs:{options:t.categories,props:t.categoryProps,clearable:"",filterable:"","show-all-levels":!1,placeholder:"选择文章分类"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.node,o=e.data;return[a("span",[t._v(t._s(o.name))]),n.isLeaf?t._e():a("span",[t._v(" ("+t._s(o.children.length)+") ")])]}}]),model:{value:t.post.categoryId,callback:function(e){t.$set(t.post,"categoryId",e)},expression:"post.categoryId"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{lg:12,md:24}},[a("el-form-item",{attrs:{label:"封面图片",prop:"thumbnail"}},[a("el-input",{attrs:{placeholder:"请输入封面图片地址"},scopedSlots:t._u([{key:"suffix",fn:function(){return[a("svg-icon",{staticStyle:{"line-height":"40px"},attrs:{name:"PictureOutlined"}})]},proxy:!0},{key:"append",fn:function(){return[a("el-button",{on:{click:t.previewThumbnail}},[t._v("预览")]),a("el-dialog",{attrs:{title:"封面预览",visible:t.previewThumbnailDialogVisible},on:{close:function(e){t.previewThumbnailDialogVisible=!1}}},[a("div",{style:t.previewThumbnailStyle})])]},proxy:!0}]),model:{value:t.post.thumbnail,callback:function(e){t.$set(t.post,"thumbnail",e)},expression:"post.thumbnail"}})],1)],1)],1)],1),a("el-row",[a("el-col",[t.loading?a("div",{directives:[{name:"loading",rawName:"v-loading.lock",value:t.loading,expression:"loading",modifiers:{lock:!0}}],staticStyle:{height:"500px"}}):a("vditor",{ref:"vditor",attrs:{id:t.vditorId,value:t.post.content,mode:t.vditorMode}})],1)],1),a("sticky",{attrs:{stickyBottom:0,"class-name":"bottom-toolbar"}},[a("el-row",{attrs:{gutter:2,type:"flex",justify:"start"}},[a("el-col",{attrs:{lg:3,md:12}},[a("el-radio-group",{model:{value:t.post.commentStatus,callback:function(e){t.$set(t.post,"commentStatus",e)},expression:"post.commentStatus"}},[a("el-radio",{attrs:{label:t.systemConst.YES}},[t._v("允许评论")]),a("el-radio",{attrs:{label:t.systemConst.NO}},[t._v("关闭评论")])],1)],1),a("el-col",{attrs:{lg:10,md:12}},[t._v(" 发布时间 "),a("el-date-picker",{staticStyle:{width:"270px"},attrs:{type:"datetime","value-format":"timestamp",placeholder:'默认点击"发布页面"按钮时的时间',size:"small"},model:{value:t.post.pubdate,callback:function(e){t.$set(t.post,"pubdate",e)},expression:"post.pubdate"}})],1),a("el-col",{attrs:{lg:11,md:24}},[a("div",{staticStyle:{float:"right"}},[t.id?a("el-button",{attrs:{type:"danger",size:"small"},on:{click:t.deletePost}},[t._v(" 删除页面 ")]):t._e(),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.submitForm("postForm",t.blogConst.POST_STATUS_DRAFT)}}},[t._v(" 存为草稿 ")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.submitForm("postForm",t.blogConst.POST_STATUS_PUBLISH)}}},[t._v(" 发布页面 ")])],1)])],1)],1)],1)},o=[],s=(a("4de4"),a("c975"),a("a15b"),a("a434"),a("ac1f"),a("1276"),a("1cd4")),i=a("ac0d"),r=a("caf6"),l=a("c405"),c=a("3294"),u={name:"PostEdit",components:{Vditor:s["a"],Sticky:c["a"]},mixins:[i["a"]],props:["id"],data:function(){return{post:{id:null,title:null,slug:null,tags:null,categoryId:null,categoryName:null,thumbnail:null,content:null,status:null,contentType:null,commentStatus:null,pingStatus:null,pubdate:null},postRules:{title:[{max:200,rigger:"blur",message:"标题长度不能超过 200 个字符"},{required:!0,message:"标题必填",trigger:"blur"}],slug:[{max:300,trigger:"blur",message:"缩略名长度不能超过 300 个字符"}],categoryId:[{required:!0,message:"必选选择一个分类",trigger:"blur"}],thumbnail:[{max:255,trigger:"blur",message:"封面图片链接不能超过 255 个字符"}]},categories:[],categoryProps:{value:"id",label:"name",children:"children",expandTrigger:"hover",checkStrictly:!0,emitPath:!1},dynamicTags:[],tagInputVisible:!1,tagInputValue:"",previewThumbnailDialogVisible:!1,loading:!1}},watch:{dynamicTags:function(t){this.post.tags=t.join(",")}},computed:{tableColumns:function(){return this.tableHead.filter((function(t){return t.display}))},vditorId:function(){return this.id?"vditor-".concat(this.id):"vditor-post-create"},vditorMode:function(){switch(this.post.contentType){case this.blogConst.POST_CONTENT_TYPE_MD:return"sv";case this.blogConst.POST_CONTENT_TYPE_HTML:return"wysiwyg";default:return"sv"}},previewThumbnailStyle:function(){return{backgroundImage:"url(".concat(this.post.thumbnail,")"),minHeight:" 260px",borderRadius:"5px",backgroundPosition:"50% 50%",backgroundSize:"cover",boxShadow:"0 1px 4px rgba(0, 0, 0, .04)"}}},created:function(){var t=this;this.loading=!0,this.id?this.getPost(this.id):(this.post.status=this.blogConst.POST_STATUS_AUTO_DRAFT,this.post.contentType=this.blogConst.POST_CONTENT_TYPE_MD,this.post.commentStatus=this.systemConst.YES,this.post.pingStatus=this.systemConst.YES,this.loading=!1),l["a"].getCategoryTree().then((function(e){t.categories=e.data})).catch((function(e){console.dir(e),t.$confirm("获取分类数据失败, 是否重新获取?","错误",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error"}).then((function(){t.getCategoryTree()})).catch((function(){}))}))},methods:{getPost:function(t){var e=this;this.loading=!0,r["a"].getPost(t).then((function(t){var a=t.data;e.post=a,e.post.tags&&(e.dynamicTags=e.post.tags.split(","))})).catch((function(){})).then((function(){e.loading=!1}))},submitForm:function(t,e){var a=this;this.$refs[t].validate((function(t){if(!t)return!1;a.post.status=e;var n=a.$refs.vditor.getCurrentMode();return"wysiwyg"===n?(a.post.content=a.$refs.vditor.getHTML(),a.post.contentType=a.blogConst.POST_CONTENT_TYPE_HTML):(a.post.content=a.$refs.vditor.getValue(),a.post.contentType=a.blogConst.POST_CONTENT_TYPE_MD),r["a"].saveOrUpdatePost(a.post).then((function(t){var e=t.data,n=e.id,o=e.pubdate;a.post.id=n,a.post.pubdate=o,a.$message.success("保存成功")})).catch((function(){a.$message.success("保存失败")})),!0}))},deletePost:function(){var t=this;this.loading=!0,r["a"].deletePost(this.post.id).then((function(){t.$message.success('删除成功, 已跳转到 "页面管理" 功能'),t.$router.push({name:"PostList"})})).catch((function(){t.$message.error("删除失败")}))},deleteTag:function(t){this.dynamicTags.splice(this.dynamicTags.indexOf(t),1)},showTagInput:function(){var t=this;this.tagInputVisible=!0,this.$nextTick((function(){t.$refs.tagInput.$refs.input.focus()}))},tagInputConfirm:function(){this.tagInputValue&&this.dynamicTags.push(this.tagInputValue),this.tagInputVisible=!1,this.tagInputValue=""},previewThumbnail:function(){this.post.thumbnail&&(this.previewThumbnailDialogVisible=!0)}}},d=u,p=(a("2371"),a("2877")),g=Object(p["a"])(d,n,o,!1,null,null,null);e["a"]=g.exports},a434:function(t,e,a){"use strict";var n=a("23e7"),o=a("23cb"),s=a("a691"),i=a("50c4"),r=a("7b0b"),l=a("65f0"),c=a("8418"),u=a("1dde"),d=a("ae40"),p=u("splice"),g=d("splice",{ACCESSORS:!0,0:0,1:2}),m=Math.max,h=Math.min,f=9007199254740991,b="Maximum allowed length exceeded";n({target:"Array",proto:!0,forced:!p||!g},{splice:function(t,e){var a,n,u,d,p,g,v=r(this),y=i(v.length),T=o(t,y),S=arguments.length;if(0===S?a=n=0:1===S?(a=0,n=y-T):(a=S-2,n=h(m(s(e),0),y-T)),y+a-n>f)throw TypeError(b);for(u=l(v,n),d=0;d<n;d++)p=T+d,p in v&&c(u,d,v[p]);if(u.length=n,a<n){for(d=T;d<y-n;d++)p=d+n,g=d+a,p in v?v[g]=v[p]:delete v[g];for(d=y;d>y-n+a;d--)delete v[d-1]}else if(a>n)for(d=y-n;d>T;d--)p=d+n-1,g=d+a-1,p in v?v[g]=v[p]:delete v[g];for(d=0;d<a;d++)v[d+T]=arguments[d+2];return v.length=y-n+a,u}})},ac0d:function(t,e,a){"use strict";a.d(e,"a",(function(){return o}));var n=a("60fe"),o={data:function(){return{blogConst:n["a"]}}}},c405:function(t,e,a){"use strict";a("b0c0");var n=a("b775"),o="/admin",s={getCategoryTree:function(){return Object(n["a"])({url:"".concat(o,"/category/tree"),method:"get"})},getCategory:function(t){return Object(n["a"])({url:"".concat(o,"/categories"),method:"get",params:{name:t}})},updateCategory:function(t){var e=t.id,a=t.name;return Object(n["a"])({url:"".concat(o,"/categories/").concat(e),method:"put",data:{name:a}})},saveCategory:function(t){var e=t.parentId,a=t.name;return Object(n["a"])({url:"".concat(o,"/categories"),method:"post",data:{parentId:e,name:a}})},deleteCategory:function(t){var e=t.id;return Object(n["a"])({url:"".concat(o,"/categories/").concat(e),method:"delete"})}};e["a"]=s},caf6:function(t,e,a){"use strict";a("a15b");var n=a("b775"),o=a("60fe"),s="/admin",i={getPost:function(t){return Object(n["a"])({url:"".concat(s,"/posts/").concat(t),method:"get"})},getPostPage:function(t){var e=t.title,a=t.slug,i=t.tags,r=t.categoryId,l=t.content,c=t.status,u=t.post,d=t.size;return Object(n["a"])({url:"".concat(s,"/posts"),method:"get",params:{title:e,slug:a,tags:i,categoryId:r,content:l,status:c,type:o["a"].POST_TYPE_POST,post:u,size:d}})},saveOrUpdatePost:function(t){var e,a=t.id,i=t.title,r=t.slug,l=t.tags,c=t.thumbnail,u=t.content,d=t.status,p=t.contentType,g=t.commentStatus,m=t.pingStatus,h=t.pubdate,f=t.categoryId;return e=a?"put":"post",Object(n["a"])({url:"".concat(s,"/posts"),method:e,data:{id:a,title:i,slug:r,tags:l,thumbnail:c,content:u,status:d,type:o["a"].POST_TYPE_POST,contentType:p,commentStatus:g,pingStatus:m,pubdate:h,categoryId:f}})},updatePost:function(t){var e=t.id,a=t.title,i=t.slug,r=t.tags,l=t.thumbnail,c=t.content,u=t.status,d=t.contentType,p=t.commentStatus,g=t.pingStatus,m=t.pubdate,h=t.categoryId;return Object(n["a"])({url:"".concat(s,"/posts/").concat(e),method:"put",data:{id:e,title:a,slug:i,tags:r,thumbnail:l,content:c,status:u,type:o["a"].POST_TYPE_POST,contentType:d,commentStatus:p,pingStatus:g,pubdate:m,categoryId:h}})},updatePostStatus:function(t,e){return Object(n["a"])({url:"".concat(s,"/posts/").concat(t,"/status"),method:"put",data:{status:e}})},deletePost:function(t){return Object(n["a"])({url:"".concat(s,"/posts/").concat(t),method:"delete"})},deletePostBatch:function(t){return Object(n["a"])({url:"".concat(s,"/posts/").concat(t.join(","),"/batch"),method:"delete"})}};e["a"]=i},db44:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("post",{attrs:{id:t.id}})},o=[],s=a("7c2b"),i={name:"PostEdit",components:{Post:s["a"]},props:["id"]},r=i,l=a("2877"),c=Object(l["a"])(r,n,o,!1,null,null,null);e["default"]=c.exports}}]);