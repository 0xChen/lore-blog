(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3250088c"],{"24af":function(e,t,n){e.exports={primaryColor:"#3298dc",menuTextColor:"rgba(255,255,255,.65)",menuActiveTextColor:"#3298dc",menuBackgroundColor:"#324157",sidebarWidth:"210px",sidebarCollapsedWidth:"64px",headerHeight:"64px"}},"2ca0":function(e,t,n){"use strict";var a=n("23e7"),r=n("06cf").f,o=n("50c4"),i=n("5a34"),c=n("1d80"),d=n("ab13"),l=n("c430"),s="".startsWith,u=Math.min,p=d("startsWith"),f=!l&&!p&&!!function(){var e=r(String.prototype,"startsWith");return e&&!e.writable}();a({target:"String",proto:!0,forced:!f&&!p},{startsWith:function(e){var t=String(c(this));i(e);var n=o(u(arguments.length>1?arguments[1]:void 0,t.length)),a=String(e);return s?s.call(t,a,n):t.slice(n,n+a.length)===a}})},a214:function(e,t,n){"use strict";var a=n("24af"),r=n.n(a);r.a},a434:function(e,t,n){"use strict";var a=n("23e7"),r=n("23cb"),o=n("a691"),i=n("50c4"),c=n("7b0b"),d=n("65f0"),l=n("8418"),s=n("1dde"),u=n("ae40"),p=s("splice"),f=u("splice",{ACCESSORS:!0,0:0,1:2}),h=Math.max,g=Math.min,m=9007199254740991,y="Maximum allowed length exceeded";a({target:"Array",proto:!0,forced:!p||!f},{splice:function(e,t){var n,a,s,u,p,f,b=c(this),v=i(b.length),x=r(e,v),C=arguments.length;if(0===C?n=a=0:1===C?(n=0,a=v-x):(n=C-2,a=g(h(o(t),0),v-x)),v+n-a>m)throw TypeError(y);for(s=d(b,a),u=0;u<a;u++)p=x+u,p in b&&l(s,u,b[p]);if(s.length=a,n<a){for(u=x;u<v-a;u++)p=u+a,f=u+n,p in b?b[f]=b[p]:delete b[f];for(u=v;u>v-a+n;u--)delete b[u-1]}else if(n>a)for(u=v-a;u>x;u--)p=u+a-1,f=u+n-1,p in b?b[f]=b[p]:delete b[f];for(u=0;u<n;u++)b[u+x]=arguments[u+2];return b.length=v-a+n,s}})},bb51:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"category"},[n("el-row",{attrs:{gutter:16}},[n("el-col",{attrs:{lg:12,md:24}},[n("el-card",{staticClass:"box-card",staticStyle:{"min-width":"550px"},attrs:{"body-style":"padding: 10px"}},[n("div",{attrs:{slot:"header"},slot:"header"},[n("el-input",{attrs:{placeholder:"搜索页面中的类别"},model:{value:e.searchText,callback:function(t){e.searchText=t},expression:"searchText"}})],1),n("el-tree",{ref:"categoryTree",attrs:{props:e.mapping,data:e.data,"node-key":"id","default-expanded-keys":e.expandedKeys,"expand-on-click-node":!0,"filter-node-method":e.searchNode,"render-content":e.renderContent}})],1)],1)],1)],1)},r=[],o=(n("4de4"),n("c740"),n("c975"),n("a434"),n("b0c0"),n("2ca0"),n("54f8")),i=n("2638"),c=n.n(i),d=n("c405"),l={name:"Category",data:function(){return{searchText:"",mapping:{label:"name",children:"children"},expandedKeys:[],newCategoryName:"",data:[],loading:!1,buttonLoading:!1}},watch:{searchText:function(e){this.$refs.categoryTree.filter(e)}},methods:{renderContent:function(e,t){var n=t.node,a=t.data,r={color:this.randomColor()};return e("div",{class:"extension-tree-node"},[e("span",{style:r},[n.label]),e("span",{class:"operation-button"},[this.renderAddButton(a,r),this.renderUpdateButton(a,r),this.renderDeleteButton(n,a,r)])])},renderAddButton:function(e,t){var n=this.$createElement,a=this,r={attrs:{placement:"left",title:'添加 "'.concat(e.name,'" 的子分类')},ref:"popper-".concat(e.id,"-create")},o={attrs:{value:this.newCategoryName,maxlength:25,"show-word-limit":!0,size:"small",placeholder:"请输入新分类名称"},on:{input:function(e){a.newCategoryName=e}}},i={on:{click:function(){a.$refs["popper-".concat(e.id,"-create")].doClose()}}},d={props:{loading:this.buttonLoading},on:{click:function(){a.create(e)}}};return n("el-popover",c()([{},r]),[n("el-input",c()([{},o])),n("div",{style:"text-align: right; margin-top: 5px"},[n("el-button",c()([{attrs:{type:"text",size:"mini"}},i]),["取消"]),n("el-button",c()([{attrs:{type:"primary",size:"mini"}},d]),["保存"])]),n("template",c()([{},{slot:"reference"}]),[n("el-button",{attrs:{type:"text"},style:t,on:{click:function(e){e.stopPropagation(),a.closePopper()}}},["添加子分类"])])])},renderUpdateButton:function(e,t){var n=this.$createElement,a=this,r={attrs:{placement:"left",title:'更改 "'.concat(e.name,'" 分类名称')},ref:"popper-".concat(e.id,"-update")},o={attrs:{value:this.newCategoryName,maxlength:25,"show-word-limit":!0,size:"small",placeholder:"请输入新名称"},on:{input:function(e){a.newCategoryName=e}}},i={on:{click:function(){a.$refs["popper-".concat(e.id,"-update")].doClose()}}},d={props:{loading:this.buttonLoading},on:{click:function(){a.update(e)}}};return n("el-popover",c()([{},r]),[n("el-input",c()([{},o])),n("div",{style:"text-align: right; margin-top: 5px"},[n("el-button",c()([{attrs:{type:"text",size:"mini"}},i]),["取消"]),n("el-button",c()([{attrs:{type:"primary",size:"mini"}},d]),["确认"])]),n("template",c()([{},{slot:"reference"}]),[n("el-button",{attrs:{type:"text"},style:t,on:{click:function(e){e.stopPropagation(),a.closePopper()}}},["修改名称"])])])},renderDeleteButton:function(e,t,n){var a=this.$createElement,r=this,o='此操作将删除 "'.concat(t.name,'" 及其下的所有子分类'),i={attrs:{placement:"left",title:o},on:{onConfirm:function(){r.delete(e,t)}}};return a("el-popconfirm",c()([{},i]),[a("template",c()([{},{slot:"reference"}]),[a("el-button",{attrs:{type:"text"},style:n,on:{click:function(e){return e.stopPropagation()}}},["删除"])])])},closePopper:function(){for(var e in this.$refs)e.startsWith("popper-")&&this.$refs[e].doClose()},searchNode:function(e,t){return""===e||-1!==t.name.indexOf(e)},defaultExpanded:function(e){var t,n=Object(o["a"])(e);try{for(n.s();!(t=n.n()).done;){var a=t.value;if(!(a.level<=2))break;this.expandedKeys.push(a.id),a.children&&a.children.length>0&&this.defaultExpanded(a.children)}}catch(r){n.e(r)}finally{n.f()}},create:function(e){var t=this;this.validateCategoryName()&&(this.buttonLoading=!0,d["a"].saveCategory({parentId:e.id,name:this.newCategoryName}).then((function(n){e.children||t.$set(e,"children",[]),e.children.push(n.data),t.$refs.categoryTree.store.nodesMap[e.id].expanded=!0,t.newCategoryName="",t.$refs["popper-".concat(e.id,"-create")].doClose()})).catch((function(e){console.dir(e)})).then((function(){t.buttonLoading=!1,t.newCategoryName=""})))},update:function(e){var t=this;this.validateCategoryName()&&(this.buttonLoading=!0,d["a"].updateCategory({id:e.id,name:this.newCategoryName}).then((function(){e.name=t.newCategoryName,t.$refs["popper-".concat(e.id,"-update")].doClose()})).catch((function(){})).then((function(){t.buttonLoading=!1,t.newCategoryName=""})))},delete:function(e,t){d["a"].deleteCategory(t).then((function(){var n=e.parent,a=n.data.children||n.data,r=a.findIndex((function(e){return e.id===t.id}));a.splice(r,1)}))},validateCategoryName:function(){return!(this.newCategoryName.length<=0)||(this.$message.warning("请输入分类名称"),!1)},getCategoryTree:function(){var e=this;this.loading=!0,d["a"].getCategoryTree().then((function(t){e.defaultExpanded(t.data),e.data=t.data,e.loading=!1})).catch((function(t){console.dir(t),e.$confirm("获取分类数据失败, 是否重新获取?","错误",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error"}).then((function(){e.getCategoryTree()})).catch((function(){})),e.loading=!1}))},randomColor:function(){var e=["rgb(121, 189, 143)","rgb(0, 163, 136)","rgb(103, 169, 207)","rgb(54, 144, 192)","rgb(1, 108, 89)","#3DB889","#9890e3","#E94A8C","#ebc0fd","#ffda8e","#fe4365"];return e[Math.floor(Math.random()*e.length)]}},mounted:function(){this.getCategoryTree()}},s=l,u=(n("a214"),n("2877")),p=Object(u["a"])(s,a,r,!1,null,null,null);t["default"]=p.exports},c405:function(e,t,n){"use strict";n("b0c0");var a=n("b775"),r="/admin",o={getCategoryTree:function(){return Object(a["a"])({url:"".concat(r,"/category/tree"),method:"get"})},getCategory:function(e){return Object(a["a"])({url:"".concat(r,"/categories"),method:"get",params:{name:e}})},updateCategory:function(e){var t=e.id,n=e.name;return Object(a["a"])({url:"".concat(r,"/categories/").concat(t),method:"put",data:{name:n}})},saveCategory:function(e){var t=e.parentId,n=e.name;return Object(a["a"])({url:"".concat(r,"/categories"),method:"post",data:{parentId:t,name:n}})},deleteCategory:function(e){var t=e.id;return Object(a["a"])({url:"".concat(r,"/categories/").concat(t),method:"delete"})}};t["a"]=o},c740:function(e,t,n){"use strict";var a=n("23e7"),r=n("b727").findIndex,o=n("44d2"),i=n("ae40"),c="findIndex",d=!0,l=i(c);c in[]&&Array(1)[c]((function(){d=!1})),a({target:"Array",proto:!0,forced:d||!l},{findIndex:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),o(c)}}]);