(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c08d7586"],{"0705":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("page")},s=[],o=a("a5ac"),i={name:"PageCreate",components:{Page:o["a"]}},l=i,r=a("2877"),u=Object(r["a"])(l,n,s,!1,null,null,null);e["default"]=u.exports},"13be":function(t,e,a){t.exports={primaryColor:"#3298dc",menuTextColor:"rgba(255,255,255,.65)",menuActiveTextColor:"#3298dc",menuBackgroundColor:"#324157",sidebarWidth:"210px",sidebarCollapsedWidth:"64px",headerHeight:"64px"}},"45a2":function(t,e,a){"use strict";a("a15b");var n=a("b775"),s=a("60fe"),o="/admin",i={getPage:function(t){return Object(n["a"])({url:"".concat(o,"/pages/").concat(t),method:"get"})},getPagePage:function(t){var e=t.title,a=t.slug,i=t.content,l=t.status,r=t.page,u=t.size;return Object(n["a"])({url:"".concat(o,"/pages"),method:"get",params:{title:e,slug:a,content:i,status:l,type:s["a"].POST_TYPE_PAGE,page:r,size:u}})},saveOrUpdatePage:function(t){var e,a=t.id,i=t.title,l=t.slug,r=t.thumbnail,u=t.content,c=t.status,g=t.contentType,d=t.commentStatus,p=t.pingStatus,m=t.pubdate,h=t.categoryId;return e=a?"put":"post",Object(n["a"])({url:"".concat(o,"/pages"),method:e,data:{id:a,title:i,slug:l,thumbnail:r,content:u,status:c,type:s["a"].POST_TYPE_PAGE,contentType:g,commentStatus:d,pingStatus:p,pubdate:m,categoryId:h}})},updatePage:function(t){var e=t.id,a=t.title,i=t.slug,l=t.thumbnail,r=t.content,u=t.status,c=t.contentType,g=t.commentStatus,d=t.pingStatus,p=t.pubdate,m=t.categoryId;return Object(n["a"])({url:"".concat(o,"/pages/").concat(e),method:"put",data:{id:e,title:a,slug:i,thumbnail:l,content:r,status:u,type:s["a"].POST_TYPE_PAGE,contentType:c,commentStatus:g,pingStatus:d,pubdate:p,categoryId:m}})},updatePageStatus:function(t,e){return Object(n["a"])({url:"".concat(o,"/pages/").concat(t,"/status"),method:"put",data:{status:e}})},deletePage:function(t){return Object(n["a"])({url:"".concat(o,"/pages/").concat(t),method:"delete"})},deletePageBatch:function(t){return Object(n["a"])({url:"".concat(o,"/pages/").concat(t.join(","),"/batch"),method:"delete"})}};e["a"]=i},a5ac:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page"},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"pageForm",attrs:{"label-position":"right","label-width":"80px",model:t.page,"status-icon":"",rules:t.pageRules}},[a("el-row",[a("el-col",{attrs:{lg:12,md:24}},[a("el-form-item",{attrs:{label:"页面标题",prop:"title"}},[a("el-input",{attrs:{placeholder:"请输入页面标题(必须)"},model:{value:t.page.title,callback:function(e){t.$set(t.page,"title",e)},expression:"page.title"}})],1)],1),a("el-col",{attrs:{lg:12,md:24}},[a("el-form-item",{attrs:{label:"缩略名称",prop:"slug"}},[a("el-input",{attrs:{placeholder:"用于自定义访问路径"},model:{value:t.page.slug,callback:function(e){t.$set(t.page,"slug",e)},expression:"page.slug"}})],1)],1)],1)],1),a("el-row",[a("el-col",[t.loading?a("div",{directives:[{name:"loading",rawName:"v-loading.lock",value:t.loading,expression:"loading",modifiers:{lock:!0}}],staticStyle:{height:"500px"}}):a("vditor",{ref:"vditor",attrs:{id:t.vditorId,value:t.page.content,mode:t.vditorMode}})],1)],1),a("sticky",{attrs:{stickyBottom:0,"class-name":"bottom-toolbar"}},[a("el-row",{attrs:{gutter:2,type:"flex",justify:"start"}},[a("el-col",{attrs:{lg:3,md:12}},[a("el-radio-group",{model:{value:t.page.commentStatus,callback:function(e){t.$set(t.page,"commentStatus",e)},expression:"page.commentStatus"}},[a("el-radio",{attrs:{label:t.systemConst.YES}},[t._v("允许评论")]),a("el-radio",{attrs:{label:t.systemConst.NO}},[t._v("关闭评论")])],1)],1),a("el-col",{attrs:{lg:10,md:12}},[t._v(" 发布时间 "),a("el-date-picker",{staticStyle:{width:"270px"},attrs:{type:"datetime","value-format":"timestamp",placeholder:'默认点击"发布页面"按钮时的时间',size:"small"},model:{value:t.page.pubdate,callback:function(e){t.$set(t.page,"pubdate",e)},expression:"page.pubdate"}})],1),a("el-col",{attrs:{lg:11,md:24}},[a("div",{staticStyle:{float:"right"}},[t.id?a("el-button",{attrs:{type:"danger",size:"small"},on:{click:t.deletePage}},[t._v(" 删除页面 ")]):t._e(),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.submitForm("pageForm",t.blogConst.POST_STATUS_DRAFT)}}},[t._v(" 存为草稿 ")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.submitForm("pageForm",t.blogConst.POST_STATUS_PUBLISH)}}},[t._v(" 发布页面 ")])],1)])],1)],1)],1)},s=[],o=(a("4de4"),a("1cd4")),i=a("ac0d"),l=a("45a2"),r=a("3294"),u={name:"PageEdit",components:{Vditor:o["a"],Sticky:r["a"]},mixins:[i["a"]],props:["id"],data:function(){return{page:{id:null,title:null,slug:null,thumbnail:null,content:null,status:null,contentType:null,commentStatus:null,pingStatus:null,pubdate:null,categoryId:null},pageRules:{title:[{max:200,rigger:"blur",message:"标题长度不能超过 200 个字符"},{required:!0,message:"标题必填",trigger:"blur"}],slug:[{max:300,trigger:"blur",message:"缩略名长度不能超过 300 个字符"}]},loading:!1}},computed:{tableColumns:function(){return this.tableHead.filter((function(t){return t.display}))},vditorId:function(){return this.id?"vditor-".concat(this.id):"vditor-page-create"},vditorMode:function(){switch(this.page.contentType){case this.blogConst.POST_CONTENT_TYPE_MD:return"sv";case this.blogConst.POST_CONTENT_TYPE_HTML:return"wysiwyg";default:return"sv"}}},created:function(){this.loading=!0,this.id?this.getPage(this.id):(this.page.status=this.blogConst.POST_STATUS_AUTO_DRAFT,this.page.contentType=this.blogConst.POST_CONTENT_TYPE_MD,this.page.commentStatus=this.systemConst.YES,this.page.pingStatus=this.systemConst.YES,this.page.categoryId=this.blogConst.CATEGORY_ROOT_ID,this.loading=!1)},methods:{getPage:function(t){var e=this;this.loading=!0,l["a"].getPage(t).then((function(t){var a=t.data;e.page=a})).catch((function(){})).then((function(){e.loading=!1}))},submitForm:function(t,e){var a=this;this.$refs[t].validate((function(t){if(!t)return!1;a.page.status=e;var n=a.$refs.vditor.getCurrentMode();return"wysiwyg"===n?(a.page.content=a.$refs.vditor.getHTML(),a.page.contentType=a.blogConst.POST_CONTENT_TYPE_HTML):(a.page.content=a.$refs.vditor.getValue(),a.page.contentType=a.blogConst.POST_CONTENT_TYPE_MD),l["a"].saveOrUpdatePage(a.page).then((function(t){var e=t.data,n=e.id,s=e.pubdate;a.page.id=n,a.page.pubdate=s,a.$message.success("保存成功")})).catch((function(){a.$message.success("保存失败")})),!0}))},deletePage:function(){var t=this;this.loading=!0,l["a"].deletePage(this.page.id).then((function(){t.$message.success('删除成功, 已跳转到 "页面管理" 功能'),t.$router.push({name:"PageList"})})).catch((function(){t.$message.error("删除失败")}))}}},c=u,g=(a("c4e8"),a("2877")),d=Object(g["a"])(c,n,s,!1,null,null,null);e["a"]=d.exports},ac0d:function(t,e,a){"use strict";a.d(e,"a",(function(){return s}));var n=a("60fe"),s={data:function(){return{blogConst:n["a"]}}}},c4e8:function(t,e,a){"use strict";var n=a("13be"),s=a.n(n);s.a}}]);